# 前端框架设计期末作业

## 基础部分

### 主页面（15分）

![主页](这里添加图片)

> 前端实现

1. 在创建此页面时，前端向后端发送初始化分类及图书请求，等待后端响应。后端响应完毕后，将所获取数据存储在vuex.state中，下次在访问分类时候，如果已经访问过直接从vue.state中获取即可。

2. 当点击购买按钮时，ajax判断localstorage中是否有“token”变量，如果存在则将token

   携带一起发送后端，否则跳转到登陆界面。

3. 点击书籍图片时，获取书籍id，发送后端，请求后端响应。后端响应完毕后，开始渲染详情页面。

> 后端实现

1. 获取到前端初始化图书请求，根据分页返回部分内容。
2. 获取到前端购买请求，将“token”解码为用户id，同时将购买书籍id写入到用户购物车表中。
3. 获取到前端书籍id，在书籍表中根据书籍id查询到书籍信息，回送前端。

### 商品详情页面（5分）

![商品详情页面](这里添加图片)

>前端实现

1. 在创建此页面时，接收传递过来的书籍id，向后端发送此书籍id号，等待后端响应。后端响应完毕后，开始渲染详情页面。

> 后端实现

1. 获取到前端获取书籍详情页请求，根据书籍id查询书籍信息，回送到前端。

### 购物车页面（15分）

![购物车页面](这里添加图片)

> 前端实现

1. 访问此界面时，路由守卫判断localstorage中是否存有“token”变量，如果有此变量，发送到后端，请求初始化购物车，等待后端响应，后端响应完毕后，开始渲染界面。如果没有此变量，将页面跳转到登陆界面。
2. 将物品从购物车删除，添加数量时，将具体操作，及"token"一起发送到后端，等待后端响应。后端响应完毕后，根据返回的信息进行提示。

> 后端实现

1. 获取到前端初始化购物车请求，将“token”解析为用户id，根据用户id在购物车表中查询用户购物车，回送到前端。
2. 获取到前端的更新购物车请求，将“token”解析为用户id，根据相应的请求在购物车表中作出修改。

### 登陆交互页面（15分）

![登陆交互页面](这里添加图片)

> 前端实现

1. 访问此界面时，路由守卫判断localstorage中是否存有“token”变量，如果有此变量，发送到后端，请求初始个人主页，等待后端响应，后端响应完毕后，开始渲染界面，并将必要的信息存放在localstorage中。如果没有此变量，将页面跳转到登陆界面。
2. 点击退出登陆，在localstorage中清除相关信息。

> 后端实现

1. 获取到前端初始化个人主页请求，将“token”解析为用户id，根据用户id在用户表中查询到用户相关信息，回送到前端。

### 搜索页面（10分）

![搜索页面](这里添加图片)

> 前端实现

1. 监听输入框，对用户每一次做出的修改都作出相应，将用户想要查询的内容发送到后端，等待后端响应。后端响应完毕后，开始渲染界面，并且将用户搜索的内容存在localstorage中。

> 后端实现

1. 对于前端发送来的每一条内容，都在书籍表中进行相似查询，并且将查询到的结果回送到前端。

## 加分项（40分）

### 主页

#### 瀑布加载

> 前端

1. 瀑布加载其实就是分页加载的一个变形，将书籍全部信息分页，选取适合的页码，一页存放数量，向后端发送请求，等待后端响应。后端响应完毕后，将响应内容存储在vuex.state中，当前页面前进一位，同时开始渲染页面。

> 后端

1. 获取前端的加载请求，根据当前页，一页存放量进行sql查询，将查询到的数据返回前端。

#### 常用搜索项目

只需要在前端就可以完成，在每一个向后端发送请求的同时，将每一次请求的内容存放在localstorage中，每一次初始化页面的时候渲染数据即可。

### 详情页

#### 商品评价

> 前端



> 后端



#### 收藏商品

> 前端

1. 点击收藏商品的时候，axios先拦截请求，如果localstorage中存在“token”变量，就将“token”一起发送后端。如果没有此变量，就跳转到登陆界面。

> 后端

1. 后端接收到前端收藏商品的请求后，将“token”解析为用户id，并且将书籍id添加在用户id的收藏表当中。

### 购物车

#### 管理页面

> 前端

1. 点击按钮之后，将界面模式进行切换，将购买界面切换为管理界面，并且将添加到收藏夹和删除两个功能模块。
2. 添加到收藏夹和删除，实际都是将当前已选中项加入到数组当中，将数组统一发送到后端，同时将localstorage中的“token”一起发送，等待后端响应。后端响应完毕后，根据响应进行反馈。

> 后端

1. 后端接收前端传递的数据，将“token”解析为用户id，然后根据收藏还是删除，在指定的用户id的表中进行增减即可。

#### 购买页面

> 前端

1. 点击购买后，将已经选中的商品，传递到订单界面。
2. 在订单界面，将所购买的商品id和“token”统一传送到后端，等待后端等待响应。后端响应完毕后，开始渲染界面。
3. 点击购买按钮之后，向后端传递订单数据，然后等待后端响应。后端响应完毕后，生成二维码等待用户付款。

> 后端

1. 后端接收前端传递的数据，将“token”解析为用户id，然后根据所购买的书籍id在书籍表中查询相关信息，然后将信息返回前端。
2. 后端接收前端传递的购买信息，然后根据“支付宝沙盒”的相关配置，回送相关信息。

### 收藏页面

> 前端

1. 在创建页面时候，将“token”发送到 后端，等待后端进行响应。后端响应完毕后，开始渲染页面。

> 后端

1. 后端接收前端传递的数据，将“token”解析为用户id，然后根据用户id在收藏表中查询信息，将查询到的信息回送到前端。

### 地址页面

> 前端

1. 在创建页面时候，将“token”发送到 后端，等待后端进行响应。后端响应完毕后，开始渲染页面。
2. 添加地址时，将保存的地址信息以及“token”发送到后端，然后等待后端进行响应。后端响应完毕后，根据响应信息进行反馈。

> 后端

1. 后端接收前端传递的数据，将“token”解析为用户id，然后根据用户id在地址表中进行查询，将查询到的信息回送到前端。
2. 后端接收前端传递的数据，将“token”解析为用户id，然后根据用户id将用户地址的增删改进行保存。



